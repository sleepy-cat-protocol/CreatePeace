                           ┌───────────────────────────────┐
                           │          用户浏览器             │
                           │(Next.js 前端 + 静态资源CDN缓存)│
                           └──────────────┬────────────────┘
                                          │ HTTPS
                                          ▼
                         ┌──────────────────────────────────┐
                         │        CDN (CloudFront/Cloudflare)│
                         └──────────────┬───────────────────┘
                                        │
                                        ▼
                  ┌─────────────────────────────────────────────┐
                  │              负载均衡器 (Load Balancer)       │
                  └───────────────┬─────────────────────────────┘
                                  │
                                  ▼
          ┌──────────────────────────────────────────┐
          │             API Gateway (NestJS)          │
          │ - 统一鉴权、路由转发                       │
          │ - API限流（Rate Limiting）                 │
          │ - 配置管理 (Config Management)             │
          │ - 请求追踪链路（Distributed Tracing）       │
          └───────────────┬──────────────────────────┘
                          │
   ┌──────────────────────┼───────────────────────┐
   │                      │                       │
   ▼                      ▼                       ▼
┌───────────────┐   ┌───────────────┐      ┌───────────────┐
│ Auth Service  │   │ User Service  │      │ Post Service  │
│ (JWT/OAuth2,  │   │ (Profile,     │      │ (发帖、编辑、   │
│ RBAC, 2FA)    │   │ Follow Graph) │      │ 图片上传至S3)  │
└───────────────┘   └───────────────┘      └───────────────┘
      │                   │                      │
      │ 读写分离           │ 读写分离               │ 读写分离
      ▼                   ▼                      ▼
 ┌─────────┐         ┌─────────┐            ┌─────────┐
 │PostgreSQL│         │PostgreSQL│            │PostgreSQL│
 │(主库/写) │         │(主库/写) │            │(主库/写) │
 └─────┬───┘         └─────┬───┘            └─────┬───┘
       │                   │                      │
  ┌────┴─────┐         ┌───┴─────┐           ┌────┴─────┐
  │只读副本  │         │只读副本 │           │只读副本  │
  │(读库)    │         │(读库)   │           │(读库)    │
  └──────────┘         └─────────┘           └──────────┘

          ┌───────────────────────────────┐
          │       Feed Service              │
          │  - 生成时间线，缓存Redis        │
          │  - 异步处理用户动态             │
          └──────────────┬────────────────┘
                         │
                         ▼
               ┌──────────────────┐
               │ Redis 缓存层      │
               │ - Feed缓存        │
               │ - Session缓存     │
               └────────┬─────────┘
                        │
                        ▼
               ┌──────────────────┐
               │ BullMQ/Redis 队列 │
               │ - 点赞/评论异步写入│
               │ - 通知异步处理     │
               └────────┬─────────┘
                        │
                        ▼
               ┌──────────────────┐
               │ NotificationSvc   │
               │ - 邮件、推送      │
               └──────────────────┘

        ┌─────────────────────────────┐
        │ Recommendation Service       │
        │ - 用户协同过滤推荐            │
        │ - Trending 热点数据          │
        └─────────────────────────────┘

          ┌─────────────────────────────┐
          │ Search Service (ElasticSearch)│
          │ - 文章、用户、标签全文检索    │
          └─────────────────────────────┘

 ┌──────────────────────────────────────────────┐
 │ 静态资源存储与分发（S3 + CDN）                  │
 │ - 图片、视频、附件                             │
 └──────────────────────────────────────────────┘

               ┌─────────────────────────────┐
               │ 监控与日志系统               │
               │ - Prometheus / Grafana       │
               │ - 日志聚合 Elastic Stack     │
               │ - 警报(Alertmanager)         │
               │ - 链路追踪（Jaeger/Opentelemetry）│
               └─────────────────────────────┘

               ┌─────────────────────────────┐
               │ 运维层                       │
               │ - 容器化 Docker + K8s         │
               │ - 多环境（Dev / Staging / Prod）│
               │ - CI/CD (GitHub Actions)      │
               │ - 灾备设计，自动扩缩容         │
               └─────────────────────────────┘
